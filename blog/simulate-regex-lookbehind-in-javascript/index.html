<!DOCTYPE html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=description content="RegEx lookbehind is a very useful tool as it allows you to check whether a string appears before a pattern you try to match. Unfortunately, it is not available in JavaScript - therefore, in order to achieve a similar effect, we have to find another way to fake it."><title>Simulate RegEx lookbehind in JavaScript | David Chin</title><link rel=canonical href="http://davidchin.me/blog/simulate-regex-lookbehind-in-javascript/"><link rel=stylesheet href="http://fonts.googleapis.com/css?family=Fira+Sans:300,400,700,300italic,400italic,700italic"><link rel=stylesheet href=/css/application.8138.css><script>window.disqus_shortname = "davidchin-blog"</script></head><body class=""><header class=global-header><div class=global-header__container><nav class=global-navigation><button id=navicon-button class=navicon-button><i class="navicon-button__icon ion-navicon"></i></button><ul class=global-navigation__menu><li><a href=/blog>Blog</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><a href="/" class=global-header__logo>David Chin</a></div></header><article><header class=page-header><div class=page-header__container><h1 class=page-header__title>Simulate RegEx lookbehind in JavaScript</h1></div></header><div class=page-content><div class=content-column><div class=blog-article><p class=blog-article__meta><strong>javascript</strong> / 12 April 2014 / <a href=/blog/simulate-regex-lookbehind-in-javascript/#disqus_thread data-disqus-identifier="/blog/simulate-regex-lookbehind-in-javascript/">0 Comments</a></p><p>RegEx lookbehind is a very useful tool as it allows you to check whether a string appears before a pattern you try to match. Unfortunately, it is not available in JavaScript - therefore, in order to achieve a similar effect, we have to find another way to fake it. One of the ways to do it is to break the intended regex into two parts and match them one after another.</p><p>Consider the following <a href="http://jsfiddle.net/dyfchin/k86VC/">example</a>, which aims to append a string to a file path if it meets certain conditions.</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// To simulate /(?&lt;=^\/images\/cars\/)([\w\-\.]*)(?=.(?:jpg|png|gif))/</span>

<span class=kd>var</span> <span class=nx>lookahead</span>   <span class=o>=</span> <span class=sr>/([\w\-\.]*)(?=.(?:jpg|png|gif))/</span><span class=p>,</span>
    <span class=nx>lookbehind</span>  <span class=o>=</span> <span class=sr>/^\/images\/cars\/$/</span><span class=p>,</span>
    <span class=nx>appendText</span>  <span class=o>=</span> <span class=s1>&#39;-car&#39;</span><span class=p>,</span>
    <span class=nx>replaceFn</span>   <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>matched</span><span class=p>,</span> <span class=nx>$1</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>var</span> <span class=nx>str</span>    <span class=o>=</span> <span class=nx>arguments</span><span class=p>[</span><span class=nx>arguments</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>1</span><span class=p>],</span>
            <span class=nx>offset</span> <span class=o>=</span> <span class=nx>arguments</span><span class=p>[</span><span class=nx>arguments</span><span class=p>.</span><span class=nx>length</span> <span class=o>-</span> <span class=mi>2</span><span class=p>];</span>
        
        <span class=k>if</span> <span class=p>(</span><span class=nx>lookbehind</span><span class=p>.</span><span class=nx>test</span><span class=p>(</span><span class=nx>str</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>offset</span><span class=p>)))</span> <span class=p>{</span>
            <span class=k>return</span> <span class=nx>$1</span> <span class=o>+</span> <span class=nx>appendText</span><span class=p>;</span>
        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
            <span class=k>return</span> <span class=nx>matched</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>};</span>

<span class=c1>// Expect filename is appended with &#39;-car&#39;</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;/images/cars/toyota.jpg&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>lookahead</span><span class=p>,</span> <span class=nx>replaceFn</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;/images/cars/honda-civic.jpg&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>lookahead</span><span class=p>,</span> <span class=nx>replaceFn</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;/images/cars/honda.png&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>lookahead</span><span class=p>,</span> <span class=nx>replaceFn</span><span class=p>));</span>

<span class=c1>// Expect nothing is replaced or appended</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;/views/cars/honda.html&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>lookahead</span><span class=p>,</span> <span class=nx>replaceFn</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;/images/cars/honda.pdf&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>lookahead</span><span class=p>,</span> <span class=nx>replaceFn</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;/images/cars/parts/wheel.jpg&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>lookahead</span><span class=p>,</span> <span class=nx>replaceFn</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;/images/motorbikes/honda.jpg&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>lookahead</span><span class=p>,</span> <span class=nx>replaceFn</span><span class=p>));</span>
<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;/assets/images/cars/honda.jpg&#39;</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=nx>lookahead</span><span class=p>,</span> <span class=nx>replaceFn</span><span class=p>));</span></code></pre></div><p>This is the regex we plan to use to match and capture the desired file names and replaced with something different.</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=sr>/(?&lt;=^\/images\/cars\/)([\w-\.]*)(?=.(?:jpg|png|gif))/</span></code></pre></div><p>To break the regex apart, firstly, we have to ignore the positive lookbehind for now and use the latter part of the regex to test against the subject. If it matches, we then use the first part of regex (without the lookbehind grouping brackets) to check against the subject again, from the beginning up to the first match. The second check ensures that the file name captured from the first check belongs to the intended folder. At last, we append the new text to the backreference of the captured match and return it inside the replace function. You can check out the <a href="http://jsfiddle.net/dyfchin/k86VC/">demo</a> here.</p></div><div class=blog-comment><div id=disqus_thread></div><script type=text/javascript>var disqus_identifier = "/blog/simulate-regex-lookbehind-in-javascript/";

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href=http://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></article><footer class=global-footer><div class=global-footer__container><nav class=global-footer-navigation><ul><li><a href=//au.linkedin.com/in/davidchin86 target=_blank>LinkedIn</a></li><li><a href=//github.com/davidchin target=_blank>GitHub</a></li><li><a href=//flickr.com/dyfchin target=_blank>Flickr</a></li><li><a href=/blog>Blog</a></li></ul></nav><aside class=fine-print-footer><div>&copy; All rights reserved.</div><div>Built with Jekyll, CoffeeScript, SASS &amp; Grunt. View <a href=//github.com/davidchin/davidchin.github.io target=_blank>source</a></div></aside></div></footer><!-- GA --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41589871-1', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');</script><!-- Disqus --><script>(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());</script><!-- CDN --><script src=https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js></script><!-- Packaged JS --><script src=/js/application.c54b.js></script></body></html>